<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Task 2.2 (universities). Тураев Тимур.</title>

<script src="task2_2_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="task2_2_files/bootstrap-2.3.2/css/bootstrap.min.css" rel="stylesheet" />
<link href="task2_2_files/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="task2_2_files/bootstrap-2.3.2/js/bootstrap.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="task2_2_files/highlight/default.css"
      type="text/css" />
<script src="task2_2_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Task 2.2 (universities). Тураев Тимур.</h1>
</div>


<pre><code>## Loading required package: RColorBrewer</code></pre>
<p>Загружаем данные, все как на паре:</p>
<pre class="r"><code>df &lt;- read.csv2(file = &quot;data/I.csv&quot;)
df &lt;- subset(df, select = c(PPIND, AVRCOMB, NEW10, FULLTIME, IN_STATE, ROOM, ADD_FEE, PH_D, GRADUAT, SAL_FULL, NUM_FULL))
df$PPIND &lt;- factor(df$PPIND, labels = c(&quot;Public&quot;, &quot;Private&quot;))
df &lt;- na.exclude(df)
df.private &lt;- subset(df, PPIND == &quot;Private&quot;)
df.private &lt;- df.private[!rownames(df.private) %in% 129, ]</code></pre>
<p>Строим регрессию, прологарифмировав денежные данные:</p>
<pre class="r"><code>l &lt;- lm(NEW10 ~ AVRCOMB + FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + log(SAL_FULL) + PH_D + GRADUAT + NUM_FULL, data = df.private)
summary(l)</code></pre>
<pre><code>## 
## Call:
## lm(formula = NEW10 ~ AVRCOMB + FULLTIME + log(IN_STATE) + log(ROOM) + 
##     log(ADD_FEE) + log(SAL_FULL) + PH_D + GRADUAT + NUM_FULL, 
##     data = df.private)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.1047 -2.8519  0.6616  3.5024  5.6159 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   -3.067e+02  2.314e+02  -1.326   0.2332  
## AVRCOMB        1.750e-01  5.925e-02   2.954   0.0255 *
## FULLTIME       2.077e-03  8.287e-04   2.507   0.0461 *
## log(IN_STATE)  1.596e+01  1.143e+01   1.396   0.2122  
## log(ROOM)      9.824e+00  1.201e+01   0.818   0.4447  
## log(ADD_FEE)   5.600e+00  3.486e+00   1.606   0.1593  
## log(SAL_FULL) -2.058e+01  3.348e+01  -0.615   0.5613  
## PH_D          -3.565e-01  6.702e-01  -0.532   0.6139  
## GRADUAT        6.508e-01  4.886e-01   1.332   0.2312  
## NUM_FULL      -1.837e-02  2.310e-02  -0.796   0.4566  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.181 on 6 degrees of freedom
## Multiple R-squared:  0.9823, Adjusted R-squared:  0.9557 
## F-statistic: 36.94 on 9 and 6 DF,  p-value: 0.0001426</code></pre>
<p>С отличниками у меня интерпретация как-то стопортися, тут сложнее, чем с государственными. Тут отличники не такой уж и показательный фактор. Так или иначе, отличники там, где много очников, спасибо КО. Можно попробовать удалить, так же как на паре, этот предиктор.</p>
<pre class="r"><code>l &lt;- lm(NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + log(SAL_FULL) + PH_D + GRADUAT + NUM_FULL, data = df.private)
summary(l)</code></pre>
<pre><code>## 
## Call:
## lm(formula = NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     log(SAL_FULL) + PH_D + GRADUAT + NUM_FULL, data = df.private)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.095 -6.555 -0.280  4.408 11.319 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   -1.314e+02  3.244e+02  -0.405  0.69759   
## FULLTIME       1.736e-03  1.190e-03   1.459  0.18806   
## log(IN_STATE)  4.050e+01  1.139e+01   3.555  0.00928 **
## log(ROOM)     -1.733e+01  1.122e+01  -1.545  0.16636   
## log(ADD_FEE)   6.309e+00  5.045e+00   1.251  0.25127   
## log(SAL_FULL) -2.421e+01  4.853e+01  -0.499  0.63320   
## PH_D          -1.044e+00  9.116e-01  -1.145  0.28972   
## GRADUAT        1.751e+00  4.587e-01   3.817  0.00657 **
## NUM_FULL       1.714e-02  2.861e-02   0.599  0.56801   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.966 on 7 degrees of freedom
## Multiple R-squared:  0.9565, Adjusted R-squared:  0.9068 
## F-statistic: 19.23 on 8 and 7 DF,  p-value: 0.0004157</code></pre>
<p>Тут не очень понятно: идти туда, где больше выпускаются, вроде логично, но идти туда где больше платить? Не знаю уж что за “частные” в Америке университеты, может логика там “чем дороже - тем лучше”?</p>
<p>Убираем незначимые признаки:</p>
<pre class="r"><code>l.aic &lt;- stepAIC(l)</code></pre>
<pre><code>## Start:  AIC=74.96
## NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     log(SAL_FULL) + PH_D + GRADUAT + NUM_FULL
## 
##                 Df Sum of Sq     RSS    AIC
## - log(SAL_FULL)  1     20.00  582.71 73.521
## - NUM_FULL       1     28.85  591.55 73.763
## &lt;none&gt;                        562.70 74.963
## - PH_D           1    105.45  668.15 75.711
## - log(ADD_FEE)   1    125.72  688.42 76.189
## - FULLTIME       1    171.01  733.71 77.208
## - log(ROOM)      1    191.78  754.49 77.655
## - log(IN_STATE)  1   1016.08 1578.79 89.469
## - GRADUAT        1   1171.30 1734.00 90.970
## 
## Step:  AIC=73.52
## NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     PH_D + GRADUAT + NUM_FULL
## 
##                 Df Sum of Sq     RSS    AIC
## - NUM_FULL       1     12.86  595.57 71.871
## &lt;none&gt;                        582.71 73.521
## - PH_D           1     85.93  668.64 73.723
## - log(ADD_FEE)   1    108.56  691.26 74.255
## - FULLTIME       1    157.29  739.99 75.345
## - log(ROOM)      1    171.86  754.56 75.657
## - log(IN_STATE)  1   1207.20 1789.90 89.477
## - GRADUAT        1   1683.29 2266.00 93.251
## 
## Step:  AIC=71.87
## NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     PH_D + GRADUAT
## 
##                 Df Sum of Sq     RSS    AIC
## &lt;none&gt;                        595.57 71.871
## - PH_D           1     98.48  694.05 72.319
## - log(ROOM)      1    173.02  768.59 73.951
## - log(ADD_FEE)   1    210.93  806.50 74.722
## - FULLTIME       1    404.06  999.62 78.157
## - log(IN_STATE)  1   1592.37 2187.94 90.690
## - GRADUAT        1   2211.43 2806.99 94.676</code></pre>
<pre class="r"><code>summary(l.aic)</code></pre>
<pre><code>## 
## Call:
## lm(formula = NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     PH_D + GRADUAT, data = df.private)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.6791 -6.2231  0.1468  3.8649 13.2114 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -3.022e+02  1.007e+02  -3.000 0.014946 *  
## FULLTIME       1.960e-03  7.933e-04   2.471 0.035511 *  
## log(IN_STATE)  3.912e+01  7.975e+00   4.905 0.000841 ***
## log(ROOM)     -1.546e+01  9.564e+00  -1.617 0.140340    
## log(ADD_FEE)   6.705e+00  3.756e+00   1.785 0.107860    
## PH_D          -8.669e-01  7.106e-01  -1.220 0.253488    
## GRADUAT        1.663e+00  2.877e-01   5.781 0.000266 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.135 on 9 degrees of freedom
## Multiple R-squared:  0.9539, Adjusted R-squared:  0.9232 
## F-statistic: 31.07 on 6 and 9 DF,  p-value: 1.599e-05</code></pre>
<p>И PH_D тоже:</p>
<pre class="r"><code>l.aic &lt;- update(l.aic, . ~ . -PH_D)
summary(l.aic)</code></pre>
<pre><code>## 
## Call:
## lm(formula = NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     GRADUAT, data = df.private)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.564  -2.879   0.832   3.434  11.407 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -3.197e+02  1.021e+02  -3.132 0.010659 *  
## FULLTIME       1.921e-03  8.118e-04   2.366 0.039538 *  
## log(IN_STATE)  3.434e+01  7.112e+00   4.828 0.000694 ***
## log(ROOM)     -1.339e+01  9.639e+00  -1.389 0.194960    
## log(ADD_FEE)   5.443e+00  3.697e+00   1.472 0.171759    
## GRADUAT        1.369e+00  1.613e-01   8.487 6.99e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.331 on 10 degrees of freedom
## Multiple R-squared:  0.9463, Adjusted R-squared:  0.9195 
## F-statistic: 35.26 on 5 and 10 DF,  p-value: 4.879e-06</code></pre>
<p>Попробуем выкинуть еще что-нибудь:</p>
<pre class="r"><code>l.aic.room &lt;- update(l.aic, . ~ . -log(ROOM))
l.aic.add_fee &lt;- update(l.aic, . ~ . -log(ADD_FEE))
l.aic.add_fee.room &lt;- update(l.aic, . ~ . -log(ADD_FEE) -log(ROOM))
anova(l.aic, l.aic.room, l.aic.add_fee, l.aic.add_fee.room)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     GRADUAT
## Model 2: NEW10 ~ FULLTIME + log(IN_STATE) + log(ADD_FEE) + GRADUAT
## Model 3: NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + GRADUAT
## Model 4: NEW10 ~ FULLTIME + log(IN_STATE) + GRADUAT
##   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)  
## 1     10  694.05                             
## 2     11  827.97 -1   -133.92 1.9296  0.195  
## 3     11  844.45  0    -16.48                
## 4     12 1101.87 -1   -257.42 3.7089  0.083 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Больше ничего не выкинуть.</p>
<pre class="r"><code>l &lt;- l.aic
summary(l)</code></pre>
<pre><code>## 
## Call:
## lm(formula = NEW10 ~ FULLTIME + log(IN_STATE) + log(ROOM) + log(ADD_FEE) + 
##     GRADUAT, data = df.private)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.564  -2.879   0.832   3.434  11.407 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -3.197e+02  1.021e+02  -3.132 0.010659 *  
## FULLTIME       1.921e-03  8.118e-04   2.366 0.039538 *  
## log(IN_STATE)  3.434e+01  7.112e+00   4.828 0.000694 ***
## log(ROOM)     -1.339e+01  9.639e+00  -1.389 0.194960    
## log(ADD_FEE)   5.443e+00  3.697e+00   1.472 0.171759    
## GRADUAT        1.369e+00  1.613e-01   8.487 6.99e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.331 on 10 degrees of freedom
## Multiple R-squared:  0.9463, Adjusted R-squared:  0.9195 
## F-statistic: 35.26 on 5 and 10 DF,  p-value: 4.879e-06</code></pre>
<p>Итоги: поступают там где больше выпускаются (то же, что и для государственных) и там где больше платить (логика непонятна, но может “раз нужно платить - то чего мелочиться”)</p>
<hr />
<p>Вторая часть задания: построить модель для всех университетов, используя эффекты взаимодействия с фактором PPIND. Строим и выкидываем незначимое.</p>
<pre class="r"><code>contrasts(df$PPIND) &lt;- contr.sum
l &lt;- lm(NEW10 ~ FULLTIME * PPIND + log(IN_STATE) * PPIND + log(ROOM) * PPIND + GRADUAT * PPIND, data = df)
summary(l)</code></pre>
<pre><code>## 
## Call:
## lm(formula = NEW10 ~ FULLTIME * PPIND + log(IN_STATE) * PPIND + 
##     log(ROOM) * PPIND + GRADUAT * PPIND, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -20.0636  -4.2228   0.6753   4.4315  21.8903 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          -9.172e+01  5.874e+01  -1.562  0.12511    
## FULLTIME              1.156e-03  4.914e-04   2.353  0.02286 *  
## PPIND1                1.692e+02  5.874e+01   2.880  0.00597 ** 
## log(IN_STATE)         1.252e+01  4.670e+00   2.681  0.01009 *  
## log(ROOM)            -9.602e+00  6.180e+00  -1.554  0.12696    
## GRADUAT               1.004e+00  1.148e-01   8.745 2.02e-11 ***
## FULLTIME:PPIND1      -7.299e-04  4.914e-04  -1.485  0.14416    
## PPIND1:log(IN_STATE) -2.240e+01  4.670e+00  -4.798 1.66e-05 ***
## PPIND1:log(ROOM)      7.646e+00  6.180e+00   1.237  0.22215    
## PPIND1:GRADUAT       -3.578e-01  1.148e-01  -3.118  0.00311 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.4 on 47 degrees of freedom
## Multiple R-squared:  0.8463, Adjusted R-squared:  0.8169 
## F-statistic: 28.76 on 9 and 47 DF,  p-value: 3.265e-16</code></pre>
<pre class="r"><code>l.aic &lt;- stepAIC(l)</code></pre>
<pre><code>## Start:  AIC=275.92
## NEW10 ~ FULLTIME * PPIND + log(IN_STATE) * PPIND + log(ROOM) * 
##     PPIND + GRADUAT * PPIND
## 
##                       Df Sum of Sq    RSS    AIC
## - PPIND:log(ROOM)      1    165.41 5244.3 275.75
## &lt;none&gt;                             5078.9 275.92
## - FULLTIME:PPIND       1    238.37 5317.2 276.53
## - PPIND:GRADUAT        1   1050.34 6129.2 284.63
## - PPIND:log(IN_STATE)  1   2487.15 7566.0 296.64
## 
## Step:  AIC=275.74
## NEW10 ~ FULLTIME + PPIND + log(IN_STATE) + log(ROOM) + GRADUAT + 
##     FULLTIME:PPIND + PPIND:log(IN_STATE) + PPIND:GRADUAT
## 
##                       Df Sum of Sq    RSS    AIC
## - log(ROOM)            1    100.15 5344.4 274.82
## &lt;none&gt;                             5244.3 275.75
## - FULLTIME:PPIND       1    294.45 5538.7 276.86
## - PPIND:GRADUAT        1   1371.80 6616.1 286.99
## - PPIND:log(IN_STATE)  1   2324.03 7568.3 294.65
## 
## Step:  AIC=274.82
## NEW10 ~ FULLTIME + PPIND + log(IN_STATE) + GRADUAT + FULLTIME:PPIND + 
##     PPIND:log(IN_STATE) + PPIND:GRADUAT
## 
##                       Df Sum of Sq    RSS    AIC
## &lt;none&gt;                             5344.4 274.82
## - FULLTIME:PPIND       1     291.6 5636.0 275.85
## - PPIND:GRADUAT        1    1519.5 6863.9 287.09
## - PPIND:log(IN_STATE)  1    2276.0 7620.4 293.05</code></pre>
<pre class="r"><code>summary(l.aic)</code></pre>
<pre><code>## 
## Call:
## lm(formula = NEW10 ~ FULLTIME + PPIND + log(IN_STATE) + GRADUAT + 
##     FULLTIME:PPIND + PPIND:log(IN_STATE) + PPIND:GRADUAT, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.427  -5.467   1.120   5.142  22.181 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          -1.544e+02  4.277e+01  -3.610 0.000719 ***
## FULLTIME              1.250e-03  4.899e-04   2.551 0.013916 *  
## PPIND1                2.184e+02  4.277e+01   5.106 5.37e-06 ***
## log(IN_STATE)         1.038e+01  4.486e+00   2.314 0.024888 *  
## GRADUAT               1.054e+00  1.101e-01   9.572 8.42e-13 ***
## FULLTIME:PPIND1      -8.011e-04  4.899e-04  -1.635 0.108439    
## PPIND1:log(IN_STATE) -2.049e+01  4.486e+00  -4.568 3.34e-05 ***
## PPIND1:GRADUAT       -4.108e-01  1.101e-01  -3.733 0.000494 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.44 on 49 degrees of freedom
## Multiple R-squared:  0.8383, Adjusted R-squared:  0.8152 
## F-statistic: 36.29 on 7 and 49 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Контрасты:</p>
<pre class="r"><code>contrasts(df$PPIND)</code></pre>
<pre><code>##         [,1]
## Public     1
## Private   -1</code></pre>
<p>Поступать туда, откуда выпускаются - это мы видели Связь платы за обучение и типа университета хорошо проглядывается: значение сильно отрицательное. Закончить немного важнее в частных (видимо, чтобы деньги не пропали) А сам тип университета, думаю, означает, что NEW10 идут в государственные университеты.</p>
<pre class="r"><code>xyplot(df$PPIND ~ df$NEW10, pch=19)</code></pre>
<p><img src="task2_2_files/figure-html/unnamed-chunk-11-1.png" title="" alt="" width="672" /></p>
<pre class="r"><code>splom(df.private)</code></pre>
<p><img src="task2_2_files/figure-html/unnamed-chunk-11-2.png" title="" alt="" width="672" /></p>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
